(()=>{var e={61:(e,t,r)=>{"use strict";e.exports=r.p+"f49492f953e31cba1910.ico"},54:(e,t,r)=>{"use strict";e.exports=r.p+"b78ce3464ac304086ef2.png"},480:(e,t,r)=>{"use strict";e.exports=r.p+"223c98620eb43647e942.jpg"},442:(e,t,r)=>{"use strict";e.exports=r.p+"f029cd16dc6b50a70b1b.jpg"},279:(e,t,r)=>{"use strict";e.exports=r.p+"6f1f62764a86f084aa84.jpg"},742:(e,t,r)=>{"use strict";e.exports=r.p+"c1a2faa0484ac7ba62fd.jpg"},184:(e,t,r)=>{"use strict";e.exports=r.p+"56a271394e0ccb32dea9.jpg"},358:(e,t,r)=>{var n={"./images/favicon.ico":61,"./images/logo.png":54,"./images/users/raphael/1.jpg":480,"./images/users/raphael/2.jpg":442,"./images/users/raphael/3.jpg":279,"./images/users/raphael/4.jpg":742,"./images/users/raphael/5.jpg":184};function a(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=o,e.exports=a,a.id=358}},t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.p="",(()=>{"use strict";const e=require("express");var t=r.n(e);const n=require("cors");var a=r.n(n);const o=require("react");var s=r.n(o);const c=require("react-dom/server");var l=r.n(c);const u=require("react-router-dom"),i=require("serialize-javascript");var m=r.n(i);const p=require("@babel/runtime/helpers/asyncToGenerator");var f=r.n(p);const d=require("@babel/runtime/helpers/slicedToArray");var g=r.n(d);const h=require("@babel/runtime/regenerator");var b=r.n(h);const v=(0,o.createContext)(null);var x="/login",y="/sign-up",E=r(54);const w=(0,o.createContext)(null);var N=r(54);function k(){var e=(0,o.useContext)(v),t=(0,o.useContext)(w).user;return s().createElement("div",{className:"h-16 bg-white"},s().createElement("div",{className:"container mx-auto max-w-screen-lg h-full"},s().createElement("div",{className:"flex justify-between h-full"},s().createElement("div",{className:"flex items-center"},s().createElement("p",{className:"mr-3"},"Click me",s().createElement("br",null)," to go back"),s().createElement(u.Link,{to:"/"},s().createElement("img",{src:N,alt:"Instagram",className:"mt-2 w-6/12"}))),s().createElement("div",{className:"text-gray-700 text-center flex items-center align-items"},t?s().createElement("button",{type:"button",title:"Sign Out",onClick:function(){e.firebase.auth().signOut()},onKeyDown:function(t){"Enter"===t.key&&e.firebase.auth().signOut()}},s().createElement("svg",{className:"w-8 mr-6 text-black-light cursor-pointer",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},s().createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"}))):s().createElement(s().Fragment,null,s().createElement(u.Link,{to:x},s().createElement("button",{type:"button",className:"bg-blue-medium font-bold text-sm rounded text-white w-20 h-8"},"Log In")),s().createElement(u.Link,{to:y},s().createElement("button",{type:"button",className:"font-bold text-sm rounded text-blue-medium w-20 h-8"},"Sign Up")))))))}const I=require("@babel/runtime/helpers/defineProperty");var C=r.n(I);const j=require("firebase/app");var O=r.n(j);require("firebase/firestore"),require("firebase/auth");var S=O().initializeApp({apiKey:"AIzaSyCcnQy0LixFoZL7D6TjTVXyC1gVLO24K70",authDomain:"instagram-yt-7c886.firebaseapp.com",projectId:"instagram-yt-7c886",storageBucket:"instagram-yt-7c886.appspot.com",messagingSenderId:"64902171109",appId:"1:64902171109:web:a15bbedba22ebd709a470c"}),P=O().firestore.FieldValue;function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){C()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function F(e){return U.apply(this,arguments)}function U(){return(U=f()(b().mark((function e(t){var r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.firestore().collection("users").where("username","==",t.toLowerCase()).get();case 2:return r=e.sent,e.abrupt("return",r.docs.length>0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return Y.apply(this,arguments)}function Y(){return(Y=f()(b().mark((function e(t){var r,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.firestore().collection("users").where("userId","==",t).get();case 2:return r=e.sent,n=r.docs.map((function(e){return L(L({},e.data()),{},{docId:e.id})})),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t){return T.apply(this,arguments)}function T(){return(T=f()(b().mark((function e(t,r){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.firestore().collection("users").limit(10).get();case 2:return n=e.sent,e.abrupt("return",n.docs.map((function(e){return L(L({},e.data()),{},{docId:e.id})})).filter((function(e){return e.userId!==t&&!r.includes(e.userId)})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e,t,r){return _.apply(this,arguments)}function _(){return(_=f()(b().mark((function e(t,r,n){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",S.firestore().collection("users").doc(t).update({following:n?P.arrayRemove(r):P.arrayUnion(r)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t,r){return R.apply(this,arguments)}function R(){return(R=f()(b().mark((function e(t,r,n){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",S.firestore().collection("users").doc(t).update({followers:n?P.arrayRemove(r):P.arrayUnion(r)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,t){return z.apply(this,arguments)}function z(){return(z=f()(b().mark((function e(t,r){var n,a,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.firestore().collection("photos").where("userId","in",r).get();case 2:return n=e.sent,a=n.docs.map((function(e){return L(L({},e.data()),{},{docId:e.id})})),e.next=6,Promise.all(a.map(function(){var e=f()(b().mark((function e(r){var n,a,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!1,r.likes.includes(t)&&(n=!0),e.next=4,A(r.userId);case 4:return a=e.sent,o=a[0].username,e.abrupt("return",L(L({username:o},r),{},{userLikedPhoto:n}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:return o=e.sent,e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){return W.apply(this,arguments)}function W(){return(W=f()(b().mark((function e(t){var r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.firestore().collection("users").where("username","==",t.toLowerCase()).get();case 2:return r=e.sent,e.abrupt("return",r.docs.map((function(e){return L(L({},e.data()),{},{docId:e.id})})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){return J.apply(this,arguments)}function J(){return(J=f()(b().mark((function e(t){var r,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.firestore().collection("photos").where("userId","==",t).get();case 2:return r=e.sent,n=r.docs.map((function(e){return L(L({},e.data()),{},{docId:e.id})})),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(e,t){return Q.apply(this,arguments)}function Q(){return(Q=f()(b().mark((function e(t,r){var n,a,o,s,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.firestore().collection("users").where("username","==",t).where("following","array-contains",r).get();case 2:return n=e.sent,a=n.docs.map((function(e){return L(L({},e.data()),{},{docId:e.id})})),o=g()(a,1),s=o[0],c=void 0===s?{}:s,e.abrupt("return",c.userId);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e,t,r,n,a){return Z.apply(this,arguments)}function Z(){return(Z=f()(b().mark((function e(t,r,n,a,o){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(r,a,t);case 2:return e.next=4,M(n,o,t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $=r(61);function ee(e){var t=e.username;return s().createElement("div",{className:"flex border-b border-gray-primary h-4 p-4 py-8"},s().createElement("div",{className:"flex items-center"},s().createElement("p",{className:"mr-3"},"Click me"),s().createElement(u.Link,{to:"/p/".concat(t),className:"flex items-center"},s().createElement("img",{className:"rounded-full h-8 w-8 flex mr-3",src:$}),s().createElement("p",{className:"font-bold"},t))))}function te(e){var t=e.src,n=e.caption,a=r(358)("./images".concat(t));return s().createElement("img",{src:a,alt:n})}function re(e){var t=e.docId,r=e.totalLikes,n=e.likedPhoto,a=e.handleFocus,c=(0,o.useContext)(w).user.uid,l=(0,o.useState)(n),u=g()(l,2),i=u[0],m=u[1],p=(0,o.useState)(r),d=g()(p,2),h=d[0],x=d[1],y=(0,o.useContext)(v),E=y.firebase,N=y.FieldValue,k=function(){var e=f()(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m((function(e){return!e})),e.next=3,E.firestore().collection("photos").doc(t).update({likes:i?N.arrayRemove(c):N.arrayUnion(c)});case 3:x((function(e){return i?e-1:e+1}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return s().createElement(s().Fragment,null,s().createElement("div",{className:"flex justify-between p-4"},s().createElement("div",{className:"flex"},s().createElement("svg",{onClick:k,onKeyDown:function(e){"Enter"===e.key&&k()},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0,className:"w-8 mr-4 select-none cursor-pointer focus:outline-none ".concat(i?"fill-red text-red-primary":"text-black-light")},s().createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})),s().createElement("svg",{onClick:a,onKeyDown:function(e){"Enter"===e.key&&a()},className:"w-8 text-black-light select-none cursor-pointer focus:outline-none",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0},s().createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})))),s().createElement("div",{className:"p-4 py-0"},s().createElement("p",{className:"font-bold"},"".concat(h,1===h?" like":" likes"))))}function ne(e){var t=e.caption,r=e.username;return s().createElement("div",{className:"p-4 pt-2 pb-1"},s().createElement("span",{className:"mr-1 font-bold"},r),s().createElement("span",{className:"italic"},t))}const ae=require("@babel/runtime/helpers/toConsumableArray");var oe=r.n(ae);function se(){var e=(0,o.useState)({}),t=g()(e,2),r=t[0],n=t[1],a=(0,o.useContext)(w).user;return(0,o.useEffect)((function(){function e(){return(e=f()(b().mark((function e(){var t,r,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(a.uid);case 2:t=e.sent,r=g()(t,1),o=r[0],n(o);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(null==a?void 0:a.uid)&&function(){e.apply(this,arguments)}()}),[a]),{user:r}}function ce(e){var t=e.docId,r=e.comments,n=e.setComments,a=e.commentInput,c=(0,o.useState)(""),l=g()(c,2),u=l[0],i=l[1],m=(0,o.useContext)(v),p=m.firebase,f=m.FieldValue,d=se().user,h=(d.fullName,d.username),b=(d.userId,d.following,function(e){return e.preventDefault(),console.log("handleSubmitComment",h),n([].concat(oe()(r),[{username:h,comment:u}])),i(""),p.firestore().collection("photos").doc(t).update({comments:f.arrayUnion({username:h,comment:u})})});return s().createElement("div",{className:"border-t border-gray-primary"},s().createElement("form",{className:"flex",onSubmit:function(e){return u.length>=1?b(e):e.preventDefault()}},s().createElement("input",{className:"w-full",type:"text",value:u,onChange:function(e){var t=e.target;return i(t.value)},ref:a}),s().createElement("button",{type:"button",onClick:b},"Post")))}function le(e){var t=e.docId,r=e.comments,n=(e.posted,e.commentInput),a=(0,o.useState)(r),c=g()(a,2),l=c[0],u=c[1],i=(0,o.useState)(3),m=g()(i,2),p=m[0],f=m[1],d=function(){f(p+3)};return s().createElement(s().Fragment,null,s().createElement("div",{className:"p-4"},l.slice(0,p).map((function(e){return s().createElement("p",{key:"".concat(e.comment,"-").concat(e.displayName),className:"mb-1"},s().createElement("span",{className:"mr-1 font-bold"},e.displayName),s().createElement("span",null,e.comment))})),l.length>=3&&p<l.length&&s().createElement("button",{className:"text-gray-base",type:"button",onClick:d,onKeyDown:function(e){"Enter"===e.key&&d()}},"View more comments")),s().createElement(ce,{docId:t,comments:l,setComments:u,commentInput:n}))}function ue(e){var t=e.content,r=(0,o.useRef)(null),n=(0,o.useContext)(w).user;return console.log("user123123",n),console.log("contentcontentcontentcontent",t),n?s().createElement("div",{className:"rounded col-span-4 border bg-white border-gray-primary mb-12"},s().createElement(ee,{username:t.username}),s().createElement(te,{src:t.imageSrc,caption:t.caption}),s().createElement(re,{docId:t.docId,totalLikes:t.likes.length,likedPhoto:t.userLikedPhoto,handleFocus:function(){return r.current.focus()}}),s().createElement(ne,{caption:t.caption,username:t.username}),s().createElement(le,{docId:t.docId,comments:t.comments,posted:t.dateCreated,commentInput:r})):s().createElement("p",{className:"font-bold"},"loading...")}function ie(){var e=(0,o.useContext)(w).user;console.log("AAVVuser",e);var t=function(e){var t=(0,o.useState)(null),r=g()(t,2),n=r[0],a=r[1];return(0,o.useEffect)((function(){function t(){return(t=f()(b().mark((function t(){var r,n,o,s;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A(e.uid);case 2:if(r=t.sent,n=g()(r,1),o=n[0].following,s=[],!(o.length>0)){t.next=10;break}return t.next=9,K(e.uid,o);case 9:s=t.sent;case 10:s.sort((function(e,t){return t.dateCreated-e.dateCreated})),a(s);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}console.log("YYYYYYYYYYYYYYAAAA",e),e&&function(){t.apply(this,arguments)}()}),[]),{photos:n}}(e).photos;return s().createElement("div",{className:"container col-span-2"},t?(null==t?void 0:t.length)>0?t.map((function(e){return s().createElement(ue,{key:e.docId,content:e})})):s().createElement("p",{className:"text-center text-2xl"},"Follow people to see Photos"):s().createElement("p",{className:"font-bold"},"loading..."))}var me=r(61);function pe(e){var t=e.username,r=e.fullName;return t&&r?s().createElement(s().Fragment,null,s().createElement("p",{className:"mr-3"},"Click me"),s().createElement(u.Link,{to:"/p/".concat(t)},s().createElement("div",{className:"grid grid-cols-4 gap-4 mb-6 items-center"},s().createElement("img",{className:"rounded-full w-16 flex mr-3",src:me}),s().createElement("div",{className:"col-span-3"},s().createElement("p",{className:"font-bold text-sm"},t),s().createElement("p",{className:"text-sm"},r))))):s().createElement("p",{className:"font-bold"},"loading...")}var fe=r(61);function de(e){var t=e.profileDocId,r=e.username,n=e.profileId,a=e.userId,c=e.loggedInUserDocId,l=(0,o.useState)(!1),u=g()(l,2),i=u[0],m=u[1];function p(){return(p=f()(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.next=3,V(c,n,!1);case 3:return e.next=5,M(t,a,!1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return i?null:s().createElement("div",{className:"flex items-center align-items justify-between"},s().createElement("div",{className:"flex items-center justify-between"},s().createElement("img",{className:"rounded-full w-8 flex mr-3",src:fe}),s().createElement("p",{className:"font-bold text-sm"},r)),s().createElement("button",{className:"text-xs font-bold text-blue-medium",type:"button",onClick:function(){return p.apply(this,arguments)}},"Follow"))}function ge(e){var t=e.userId,r=e.following,n=e.loggedInUserDocId,a=(0,o.useState)(null),c=g()(a,2),l=c[0],u=c[1];return(0,o.useEffect)((function(){function e(){return(e=f()(b().mark((function e(){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(t,r);case 2:n=e.sent,u(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t&&function(){e.apply(this,arguments)}()}),[t]),l?l.length>0?s().createElement(s().Fragment,null,s().createElement("p",{className:"font-bold"},"Suggestions for you"),s().createElement("div",{className:"mt-4 grid gap-5"},l.map((function(e){return s().createElement(de,{key:e.docId,profileDocId:e.docId,username:e.username,profileId:e.userId,userId:t,loggedInUserDocId:n})})))):null:s().createElement("p",{className:"font-bold"},"loading...")}function he(){var e=se().user,t=e.docId,r=e.fullName,n=e.username,a=e.userId,o=e.following;return s().createElement("div",{className:"p-4"},s().createElement(pe,{username:n,fullName:r}),s().createElement(ge,{userId:a,following:o,loggedInUserDocId:t}))}var be=r(54),ve=r(61);function xe(e){var t=e.photosCount,r=e.followerCount,n=e.setFollowerCount,a=e.profile,c=a.docId,l=a.userId,u=a.fullName,i=a.followers,m=a.following,p=a.username,d=(0,o.useContext)(w).user,h=se(null==d||d.uid).user,v=(0,o.useState)(null),x=g()(v,2),y=x[0],E=x[1],N=(null==h?void 0:h.username)&&(null==h?void 0:h.username)!==p,k=function(){var e=f()(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E((function(e){return!e})),n({followerCount:y?r-1:r+1}),e.next=4,X(y,h.docId,c,l,h.userId);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){var e=function(){var e=f()(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(h.username,l);case 2:t=e.sent,E(!!t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(null==h?void 0:h.username)&&l&&e()}),[null==h?void 0:h.username,l]),s().createElement("div",{className:"grid grid-cols-3"},s().createElement("div",{className:"container flex justify-center items-center"},p?s().createElement("img",{className:"rounded-full h-40 w-40 flex",src:ve}):s().createElement("p",{className:"font-bold"},"loading...")),s().createElement("div",{className:"flex items-center justify-center flex-col "},s().createElement("div",{className:"container flex items-center"},s().createElement("p",{className:"text-2xl mr-4"},p),N&&null===y?s().createElement("p",{className:"font-bold"},"loading..."):N&&s().createElement("button",{className:"text-xs font-bold text-blue-medium",type:"button",onClick:k,onKeyDown:function(e){"Enter"===e.key&&k()}},y?"Unfollow":"Follow")),s().createElement("div",{className:"container flex mt-4"},i&&m?s().createElement(s().Fragment,null,s().createElement("p",{className:"mr-10"},s().createElement("span",{className:"font-bold"},t)," photos"),s().createElement("p",{className:"mr-10"},s().createElement("span",{className:"font-bold"},r),1===r?"follower":"followers"),s().createElement("p",{className:"mr-10"},s().createElement("span",{className:"font-bold"},null==m?void 0:m.length)," following")):s().createElement("p",{className:"font-bold"},"loading...")),s().createElement("div",{className:"container mt-4"},s().createElement("p",{className:"font-medium"},u||s().createElement("p",{className:"font-bold"},"loading...")))))}function ye(e){var t=e.photos;return s().createElement("div",{className:"grid grid-cols-3 gap-8 mt-4"},t?t.length>0?t.map((function(e){return s().createElement("img",{src:r(358)("./images".concat(e.imageSrc))})})):null:new Array(12).fill(0).map((function(e){return s().createElement("p",{className:"font-bold"},"loading...")})))}function Ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function we(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(r),!0).forEach((function(t){C()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ne(e){var t=e.user,r=(0,o.useReducer)((function(e,t){return we(we({},e),t)}),{profile:{},photosCollection:null,followerCount:0}),n=g()(r,2),a=n[0],c=a.profile,l=a.photosCollection,u=a.followerCount,i=n[1];return(0,o.useEffect)((function(){function e(){return(e=f()(b().mark((function e(){var r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(t.userId);case 2:r=e.sent,i({profile:t,photosCollection:r,followerCount:t.followers.length});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t.username]),s().createElement(s().Fragment,null,s().createElement(xe,{photosCount:l?l.length:0,profile:c,followerCount:u,setFollowerCount:i}),s().createElement(ye,{photos:l}))}const ke=[{path:"/",exact:!0,component:function(){return(0,o.useEffect)((function(){document.title="Instagram"}),[]),s().createElement("div",{className:"bg-gray-background"},s().createElement(k,null),s().createElement("div",{className:"grid grid-cols-3 gap-4 justify-between mx-auto max-w-screen-lg"},s().createElement(ie,null),s().createElement(he,null)))}},{path:"/login",exact:!0,component:function(){var e=(0,u.useHistory)(),t=(0,o.useContext)(v),r=(0,o.useState)(""),n=g()(r,2),a=n[0],c=n[1],l=(0,o.useState)(""),i=g()(l,2),m=i[0],p=i[1],d=(0,o.useState)(""),h=g()(d,2),x=h[0],w=h[1],N=""===m||""===a,k=function(){var r=f()(b().mark((function r(n){return b().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n.preventDefault(),r.prev=1,r.next=4,t.firebase.auth().signInWithEmailAndPassword(a,m);case 4:e.push("/"),r.next=12;break;case 7:r.prev=7,r.t0=r.catch(1),c(""),p(""),w(r.t0.message);case 12:case"end":return r.stop()}}),r,null,[[1,7]])})));return function(e){return r.apply(this,arguments)}}();return(0,o.useEffect)((function(){document.title="Login - Instagram"}),[]),s().createElement("div",{className:"container flex mx-auto max-w-screen-md items-center h-screen"},s().createElement("div",{className:"flex flex-col w-2/5 mx-auto"},s().createElement("div",{className:"flex flex-col"},s().createElement("h1",{className:"flex justify-center w-full"},s().createElement("img",{src:E,alt:"Instagram",className:"mt-2 w-6/12 mb-4"})),x&&s().createElement("p",{className:"mb-4 text-xs text-red-primary"},x),s().createElement("form",{onSubmit:k,method:"POST"},s().createElement("input",{"aria-label":"Enter your email address",type:"text",placeholder:"Email address",className:"text-sm text-gray-base w-full mr-3 py-5 px-4 h-2 border border-gray-primary rounded mb-2",onChange:function(e){var t=e.target;return c(t.value)},value:a}),s().createElement("input",{"aria-label":"Enter your password",type:"password",placeholder:"Password",className:"text-sm text-gray-base w-full mr-3 py-5 px-4 h-2 border border-gray-primary rounded mb-2",onChange:function(e){var t=e.target;return p(t.value)},value:m}),s().createElement("button",{disabled:N,type:"submit",className:"bg-blue-medium text-white w-full rounded h-8 font-bold\n            ".concat(N&&"opacity-50")},"Login"))),s().createElement("div",{className:"flex justify-center items-center flex-col w-full bg-white p-4 rounded border border-gray-primary"},s().createElement("p",{className:"text-sm"},"Don't have an account?"," ",s().createElement(u.Link,{to:y,className:"font-bold"},"Sign up")))))}},{path:"/sign-up",exact:!0,component:function(){var e=(0,u.useHistory)(),t=(0,o.useContext)(v),r=(0,o.useState)(""),n=g()(r,2),a=n[0],c=n[1],l=(0,o.useState)(""),i=g()(l,2),m=i[0],p=i[1],d=(0,o.useState)(""),h=g()(d,2),y=h[0],E=h[1],w=(0,o.useState)(""),N=g()(w,2),k=N[0],I=N[1],C=(0,o.useState)(""),j=g()(C,2),O=j[0],S=j[1],P=""===k||""===y,D=function(){var r=f()(b().mark((function r(n){var o;return b().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n.preventDefault(),r.next=3,F(a);case 3:if(r.sent){r.next=24;break}return r.prev=5,r.next=8,t.firebase.auth().createUserWithEmailAndPassword(y,k);case 8:return o=r.sent,r.next=11,o.user.updateProfile({displayName:a});case 11:return r.next=13,t.firebase.firestore().collection("users").add({userId:o.user.uid,username:a.toLowerCase(),fullName:m,emailAddress:y.toLowerCase(),following:["2"],followers:[],dateCreated:Date.now()});case 13:e.push("/"),r.next=22;break;case 16:r.prev=16,r.t0=r.catch(5),p(""),E(""),I(""),S(r.t0.message);case 22:r.next=26;break;case 24:c(""),S("That username is already taken, please try another.");case 26:case"end":return r.stop()}}),r,null,[[5,16]])})));return function(e){return r.apply(this,arguments)}}();return(0,o.useEffect)((function(){document.title="Sign Up - Instagram"}),[]),s().createElement("div",{className:"container flex mx-auto max-w-screen-md items-center h-screen"},s().createElement("div",{className:"flex flex-col w-2/5 mx-auto"},s().createElement("div",{className:"flex flex-col"},s().createElement("h1",{className:"flex justify-center w-full"},s().createElement("img",{src:be,alt:"Instagram",className:"mt-2 w-6/12 mb-4"})),O&&s().createElement("p",{className:"mb-4 text-xs text-red-primary"},O),s().createElement("form",{onSubmit:D,method:"POST"},s().createElement("input",{"aria-label":"Enter your username",type:"text",placeholder:"Username",className:"text-sm text-gray-base w-full mr-3 py-5 px-4 h-2 border border-gray-primary rounded mb-2",onChange:function(e){var t=e.target;return c(t.value)},value:a}),s().createElement("input",{"aria-label":"Enter your full name",type:"text",placeholder:"Full name",className:"text-sm text-gray-base w-full mr-3 py-5 px-4 h-2 border border-gray-primary rounded mb-2",onChange:function(e){var t=e.target;return p(t.value)},value:m}),s().createElement("input",{"aria-label":"Enter your email address",type:"text",placeholder:"Email address",className:"text-sm text-gray-base w-full mr-3 py-5 px-4 h-2 border border-gray-primary rounded mb-2",onChange:function(e){var t=e.target;return E(t.value)},value:y}),s().createElement("input",{"aria-label":"Enter your password",type:"password",placeholder:"Password",className:"text-sm text-gray-base w-full mr-3 py-5 px-4 h-2 border border-gray-primary rounded mb-2",onChange:function(e){var t=e.target;return I(t.value)},value:k}),s().createElement("button",{disabled:P,type:"submit",className:"bg-blue-medium text-white w-full rounded h-8 font-bold\n            ".concat(P&&"opacity-50")},"Sign Up"))),s().createElement("div",{className:"flex justify-center items-center flex-col w-full bg-white p-4 rounded border border-gray-primary"},s().createElement("p",{className:"text-sm"},"Have an account?"," ",s().createElement(u.Link,{to:x,className:"font-bold"},"Login")))))}},{path:"/p",component:function(e){var t=e.data.location.pathname.split("/").pop(),r=(0,o.useState)(null),n=g()(r,2),a=n[0],c=n[1];return(0,o.useEffect)((function(){function e(){return(e=f()(b().mark((function e(){var r,n,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(t);case 2:r=e.sent,n=g()(r,1),(null==(a=n[0])?void 0:a.userId)&&c(a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t]),(null==a?void 0:a.username)?s().createElement("div",{className:"bg-gray-background"},s().createElement(k,null),s().createElement("div",{className:"mx-auto max-w-screen-lg"},s().createElement(Ne,{user:a}))):null}}],Ie=(0,o.createContext)(null);function Ce(e){var t=function(){var e=(0,o.useContext)(Ie);if(!e)return{};var t=(0,o.useState)(JSON.parse(e.localStorage.getItem("authUser"))),r=g()(t,2),n=r[0],a=r[1],s=(0,o.useContext)(v);return(0,o.useEffect)((function(){var t=s.firebase.auth().onAuthStateChanged((function(t){t?(e.localStorage.setItem("authUser",JSON.stringify(t)),a(t)):(e.localStorage.removeItem("authUser"),a(null))}));return function(){return t()}}),[s]),{user:n}}().user;return o.createElement(w.Provider,{value:{user:t}},o.createElement(u.Switch,null,ke.map((function(e){var t=e.path,r=e.exact,n=(e.fetchInitialData,e.component);return o.createElement(u.Route,{key:t,path:t,exact:r,render:function(e){return o.createElement(n,{data:e})}})}))))}var je=t()();je.use(a()()),je.use(t().static("dist")),je.get("*",(function(e,t,r){var n=ke.find((function(t){return(0,u.matchPath)(e.url,t)}))||{};(n.fetchInitialData?n.fetchInitialData(e.path):Promise.resolve()).then((function(r){var n=l().renderToString(o.createElement(u.StaticRouter,{location:e.url,context:{data:r}},o.createElement(Ce,null)));t.send('\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <script src="/bundle.js" defer><\/script>\n          <link href="/main.css" rel="stylesheet">\n          <script>window.__INITIAL_DATA__ = '.concat(m()(r),'<\/script>\n        </head>\n\n        <body>\n          <div id="app">').concat(n,"</div>\n        </body>\n      </html>\n    "))})).catch(r)}));var Oe=process.env.PORT||3e3;je.listen(Oe,(function(){console.log("Server is listening on port: ".concat(Oe))}))})()})();