(()=>{var e={61:(e,t,n)=>{"use strict";e.exports=n.p+"f49492f953e31cba1910.ico"},54:(e,t,n)=>{"use strict";e.exports=n.p+"b78ce3464ac304086ef2.png"},480:(e,t,n)=>{"use strict";e.exports=n.p+"223c98620eb43647e942.jpg"},442:(e,t,n)=>{"use strict";e.exports=n.p+"f029cd16dc6b50a70b1b.jpg"},279:(e,t,n)=>{"use strict";e.exports=n.p+"6f1f62764a86f084aa84.jpg"},742:(e,t,n)=>{"use strict";e.exports=n.p+"c1a2faa0484ac7ba62fd.jpg"},184:(e,t,n)=>{"use strict";e.exports=n.p+"56a271394e0ccb32dea9.jpg"},358:(e,t,n)=>{var r={"./images/favicon.ico":61,"./images/logo.png":54,"./images/users/raphael/1.jpg":480,"./images/users/raphael/2.jpg":442,"./images/users/raphael/3.jpg":279,"./images/users/raphael/4.jpg":742,"./images/users/raphael/5.jpg":184};function a(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=o,e.exports=a,a.id=358}},t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.p="",(()=>{"use strict";const e=require("express");var t=n.n(e);const r=require("cors");var a=n.n(r);const o=require("react");var c=n.n(o);const s=require("react-dom/server");var l=n.n(s);const u=require("react-router-dom"),i=require("serialize-javascript");var m=n.n(i);const p=require("@babel/runtime/helpers/extends");var f=n.n(p);const d=require("@babel/runtime/helpers/asyncToGenerator");var v=n.n(d);const g=require("@babel/runtime/helpers/slicedToArray");var h=n.n(g);const b=require("@babel/runtime/regenerator");var E=n.n(b);const x=(0,o.createContext)(null);var w="/login",y="/sign-up",N=n(54);const k=(0,o.createContext)(null);var I=n(54);function C(){var e=(0,o.useContext)(x),t=(0,o.useContext)(k).user;return c().createElement("div",{className:"h-16 bg-white"},c().createElement("div",{className:"container mx-auto max-w-screen-lg h-full"},c().createElement("div",{className:"flex justify-between h-full"},c().createElement("div",{className:"flex items-center"},c().createElement("p",{className:"mr-3"},"Click me",c().createElement("br",null)," to go back"),c().createElement(u.Link,{to:"/"},c().createElement("img",{src:I,alt:"Instagram",className:"mt-2 w-6/12"}))),c().createElement("div",{className:"text-gray-700 text-center flex items-center align-items"},t?c().createElement("button",{type:"button",title:"Sign Out",onClick:function(){e.firebase.auth().signOut()},onKeyDown:function(t){"Enter"===t.key&&e.firebase.auth().signOut()}},c().createElement("svg",{className:"w-8 mr-6 text-black-light cursor-pointer",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},c().createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"}))):c().createElement(c().Fragment,null,c().createElement(u.Link,{to:w},c().createElement("button",{type:"button",className:"bg-blue-medium"},"Log In")),c().createElement(u.Link,{to:y},c().createElement("button",{type:"button"},"Sign Up")))))))}const j=require("@babel/runtime/helpers/defineProperty");var O=n.n(j);const S=require("firebase/app");var P=n.n(S);require("firebase/firestore"),require("firebase/auth");var D=P().initializeApp({apiKey:"AIzaSyCcnQy0LixFoZL7D6TjTVXyC1gVLO24K70",authDomain:"instagram-yt-7c886.firebaseapp.com",projectId:"instagram-yt-7c886",storageBucket:"instagram-yt-7c886.appspot.com",messagingSenderId:"64902171109",appId:"1:64902171109:web:a15bbedba22ebd709a470c"}),L=P().firestore.FieldValue;function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e){return q.apply(this,arguments)}function q(){return(q=v()(E().mark((function e(t){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.firestore().collection("users").where("username","==",t.toLowerCase()).get();case 2:return n=e.sent,e.abrupt("return",n.docs.length>0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){return T.apply(this,arguments)}function T(){return(T=v()(E().mark((function e(t){var n,r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.firestore().collection("users").where("userId","==",t).get();case 2:return n=e.sent,r=n.docs.map((function(e){return A(A({},e.data()),{},{docId:e.id})})),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e,t){return _.apply(this,arguments)}function _(){return(_=v()(E().mark((function e(t,n){var r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.firestore().collection("users").limit(10).get();case 2:return r=e.sent,e.abrupt("return",r.docs.map((function(e){return A(A({},e.data()),{},{docId:e.id})})).filter((function(e){return e.userId!==t&&!n.includes(e.userId)})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t,n){return R.apply(this,arguments)}function R(){return(R=v()(E().mark((function e(t,n,r){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",D.firestore().collection("users").doc(t).update({following:r?L.arrayRemove(n):L.arrayUnion(n)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,t,n){return z.apply(this,arguments)}function z(){return(z=v()(E().mark((function e(t,n,r){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",D.firestore().collection("users").doc(t).update({followers:r?L.arrayRemove(n):L.arrayUnion(n)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e,t){return W.apply(this,arguments)}function W(){return(W=v()(E().mark((function e(t,n){var r,a,o;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.firestore().collection("photos").where("userId","in",n).get();case 2:return r=e.sent,a=r.docs.map((function(e){return A(A({},e.data()),{},{docId:e.id})})),e.next=6,Promise.all(a.map(function(){var e=v()(E().mark((function e(n){var r,a,o;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!1,n.likes.includes(t)&&(r=!0),e.next=4,Y(n.userId);case 4:return a=e.sent,o=a[0].username,e.abrupt("return",A(A({username:o},n),{},{userLikedPhoto:r}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:return o=e.sent,e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){return J.apply(this,arguments)}function J(){return(J=v()(E().mark((function e(t){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.firestore().collection("users").where("username","==",t.toLowerCase()).get();case 2:return n=e.sent,e.abrupt("return",n.docs.map((function(e){return A(A({},e.data()),{},{docId:e.id})})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(e){return Q.apply(this,arguments)}function Q(){return(Q=v()(E().mark((function e(t){var n,r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.firestore().collection("photos").where("userId","==",t).get();case 2:return n=e.sent,r=n.docs.map((function(e){return A(A({},e.data()),{},{docId:e.id})})),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e,t){return Z.apply(this,arguments)}function Z(){return(Z=v()(E().mark((function e(t,n){var r,a,o,c,s;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.firestore().collection("users").where("username","==",t).where("following","array-contains",n).get();case 2:return r=e.sent,a=r.docs.map((function(e){return A(A({},e.data()),{},{docId:e.id})})),o=h()(a,1),c=o[0],s=void 0===c?{}:c,e.abrupt("return",s.userId);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e,t,n,r,a){return ee.apply(this,arguments)}function ee(){return(ee=v()(E().mark((function e(t,n,r,a,o){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(n,a,t);case 2:return e.next=4,K(r,o,t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var te=n(61);function ne(e){var t=e.username;return c().createElement("div",{className:"flex border-b border-gray-primary h-4 p-4 py-8"},c().createElement("div",{className:"flex items-center"},c().createElement("p",{className:"mr-3"},"Click me"),c().createElement(u.Link,{to:"/p/".concat(t),className:"flex items-center"},c().createElement("img",{className:"rounded-full h-8 w-8 flex mr-3",src:te}),c().createElement("p",{className:"font-bold"},t))))}function re(e){var t=e.src,r=e.caption,a=n(358)("./images".concat(t));return c().createElement("img",{src:a,alt:r})}function ae(e){var t=e.docId,n=e.totalLikes,r=e.likedPhoto,a=e.handleFocus,s=(0,o.useContext)(k).user.uid,l=(0,o.useState)(r),u=h()(l,2),i=u[0],m=u[1],p=(0,o.useState)(n),f=h()(p,2),d=f[0],g=f[1],b=(0,o.useContext)(x),w=b.firebase,y=b.FieldValue,N=function(){var e=v()(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m((function(e){return!e})),e.next=3,w.firestore().collection("photos").doc(t).update({likes:i?y.arrayRemove(s):y.arrayUnion(s)});case 3:g((function(e){return i?e-1:e+1}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c().createElement(c().Fragment,null,c().createElement("div",{className:"flex justify-between p-4"},c().createElement("div",{className:"flex"},c().createElement("svg",{onClick:N,onKeyDown:function(e){"Enter"===e.key&&N()},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0,className:"w-8 mr-4 select-none cursor-pointer focus:outline-none ".concat(i?"fill-red text-red-primary":"text-black-light")},c().createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})),c().createElement("svg",{onClick:a,onKeyDown:function(e){"Enter"===e.key&&a()},className:"w-8 text-black-light select-none cursor-pointer focus:outline-none",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0},c().createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})))),c().createElement("div",{className:"p-4 py-0"},c().createElement("p",{className:"font-bold"},"".concat(d,1===d?" like":" likes"))))}function oe(e){var t=e.caption,n=e.username;return c().createElement("div",{className:"p-4 pt-2 pb-1"},c().createElement("span",{className:"mr-1 font-bold"},n),c().createElement("span",{className:"italic"},t))}const ce=require("@babel/runtime/helpers/toConsumableArray");var se=n.n(ce);function le(){var e=(0,o.useState)({}),t=h()(e,2),n=t[0],r=t[1],a=(0,o.useContext)(k).user;return(0,o.useEffect)((function(){function e(){return(e=v()(E().mark((function e(){var t,n,o;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(a.uid);case 2:t=e.sent,n=h()(t,1),o=n[0],r(o);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(null==a?void 0:a.uid)&&function(){e.apply(this,arguments)}()}),[a]),{user:n}}function ue(e){var t=e.docId,n=e.comments,r=e.setComments,a=e.commentInput,s=(0,o.useState)(""),l=h()(s,2),u=l[0],i=l[1],m=(0,o.useContext)(x),p=m.firebase,f=m.FieldValue,d=le().user,v=(d.fullName,d.username),g=(d.userId,d.following,function(e){return e.preventDefault(),console.log("handleSubmitComment",v),r([].concat(se()(n),[{username:v,comment:u}])),i(""),p.firestore().collection("photos").doc(t).update({comments:f.arrayUnion({username:v,comment:u})})});return c().createElement("div",{className:"border-t border-gray-primary"},c().createElement("form",{className:"flex",onSubmit:function(e){return u.length>=1?g(e):e.preventDefault()}},c().createElement("input",{className:"w-full",type:"text",value:u,onChange:function(e){var t=e.target;return i(t.value)},ref:a}),c().createElement("button",{type:"button",onClick:g},"Post")))}function ie(e){var t=e.docId,n=e.comments,r=(e.posted,e.commentInput),a=(0,o.useState)(n),s=h()(a,2),l=s[0],u=s[1],i=(0,o.useState)(3),m=h()(i,2),p=m[0],f=m[1],d=function(){f(p+3)};return c().createElement(c().Fragment,null,c().createElement("div",{className:"p-4"},l.slice(0,p).map((function(e){return c().createElement("p",{key:"".concat(e.comment,"-").concat(e.displayName),className:"mb-1"},c().createElement("span",{className:"mr-1 font-bold"},e.displayName),c().createElement("span",null,e.comment))})),l.length>=3&&p<l.length&&c().createElement("button",{className:"text-gray-base",type:"button",onClick:d,onKeyDown:function(e){"Enter"===e.key&&d()}},"View more comments")),c().createElement(ue,{docId:t,comments:l,setComments:u,commentInput:r}))}function me(e){var t=e.content,n=(0,o.useRef)(null),r=(0,o.useContext)(k).user;return console.log("user123123",r),console.log("contentcontentcontentcontent",t),r?c().createElement("div",{className:"rounded col-span-4 border bg-white border-gray-primary mb-12"},c().createElement(ne,{username:t.username}),c().createElement(re,{src:t.imageSrc,caption:t.caption}),c().createElement(ae,{docId:t.docId,totalLikes:t.likes.length,likedPhoto:t.userLikedPhoto,handleFocus:function(){return n.current.focus()}}),c().createElement(oe,{caption:t.caption,username:t.username}),c().createElement(ie,{docId:t.docId,comments:t.comments,posted:t.dateCreated,commentInput:n})):c().createElement("p",{className:"font-bold"},"loading...")}function pe(){var e=(0,o.useContext)(k).user;console.log("AAVVuser",e);var t=function(e){var t=(0,o.useState)(null),n=h()(t,2),r=n[0],a=n[1];return(0,o.useEffect)((function(){function t(){return(t=v()(E().mark((function t(){var n,r,o,c;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y(e.uid);case 2:if(n=t.sent,r=h()(n,1),o=r[0].following,c=[],!(o.length>0)){t.next=10;break}return t.next=9,H(e.uid,o);case 9:c=t.sent;case 10:c.sort((function(e,t){return t.dateCreated-e.dateCreated})),a(c);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}console.log("YYYYYYYYYYYYYYAAAA",e),e&&function(){t.apply(this,arguments)}()}),[]),{photos:r}}(e).photos;return c().createElement("div",{className:"container col-span-2"},t?(null==t?void 0:t.length)>0?t.map((function(e){return c().createElement(me,{key:e.docId,content:e})})):c().createElement("p",{className:"text-center text-2xl"},"Follow people to see Photos"):c().createElement("p",{className:"font-bold"},"loading..."))}var fe=n(61);function de(e){var t=e.username,n=e.fullName;return t&&n?c().createElement(c().Fragment,null,c().createElement("p",{className:"mr-3"},"Click me"),c().createElement(u.Link,{to:"/p/".concat(t)},c().createElement("div",{className:"grid grid-cols-4 gap-4 mb-6 items-center"},c().createElement("img",{className:"rounded-full w-16 flex mr-3",src:fe}),c().createElement("div",{className:"col-span-3"},c().createElement("p",{className:"font-bold text-sm"},t),c().createElement("p",{className:"text-sm"},n))))):c().createElement("p",{className:"font-bold"},"loading...")}var ve=n(61);function ge(e){var t=e.profileDocId,n=e.username,r=e.profileId,a=e.userId,s=e.loggedInUserDocId,l=(0,o.useState)(!1),u=h()(l,2),i=u[0],m=u[1];function p(){return(p=v()(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.next=3,M(s,r,!1);case 3:return e.next=5,K(t,a,!1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return i?null:c().createElement("div",{className:"flex items-center align-items justify-between"},c().createElement("div",{className:"flex items-center justify-between"},c().createElement("img",{className:"rounded-full w-8 flex mr-3",src:ve}),c().createElement("p",{className:"font-bold text-sm"},n)),c().createElement("button",{className:"text-xs font-bold text-blue-medium",type:"button",onClick:function(){return p.apply(this,arguments)}},"Follow"))}function he(e){var t=e.userId,n=e.following,r=e.loggedInUserDocId,a=(0,o.useState)(null),s=h()(a,2),l=s[0],u=s[1];return(0,o.useEffect)((function(){function e(){return(e=v()(E().mark((function e(){var r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(t,n);case 2:r=e.sent,u(r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t&&function(){e.apply(this,arguments)}()}),[t]),l?l.length>0?c().createElement(c().Fragment,null,c().createElement("p",{className:"font-bold"},"Suggestions for you"),c().createElement("div",{className:"mt-4 grid gap-5"},l.map((function(e){return c().createElement(ge,{key:e.docId,profileDocId:e.docId,username:e.username,profileId:e.userId,userId:t,loggedInUserDocId:r})})))):null:c().createElement("p",{className:"font-bold"},"loading...")}function be(){var e=le().user,t=e.docId,n=e.fullName,r=e.username,a=e.userId,o=e.following;return c().createElement("div",{className:"p-4"},c().createElement(de,{username:r,fullName:n}),c().createElement(he,{userId:a,following:o,loggedInUserDocId:t}))}var Ee=n(54);function xe(e){var t=e.photosCount,n=e.followerCount,r=e.setFollowerCount,a=e.profile,s=a.docId,l=a.userId,u=a.fullName,i=a.followers,m=a.following,p=a.username,f=(0,o.useContext)(k).user,d=le(null==f||f.uid).user,g=(0,o.useState)(null),b=h()(g,2),x=b[0],w=b[1],y=(null==d?void 0:d.username)&&(null==d?void 0:d.username)!==p,N=function(){var e=v()(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w((function(e){return!e})),r({followerCount:x?n-1:n+1}),e.next=4,$(x,d.docId,s,l,d.userId);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){var e=function(){var e=v()(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X(d.username,l);case 2:t=e.sent,w(!!t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(null==d?void 0:d.username)&&l&&e()}),[null==d?void 0:d.username,l]),c().createElement("div",{className:"grid grid-cols-3"},c().createElement("div",{className:"container flex justify-center items-center"},p?c().createElement("img",{className:"rounded-full h-40 w-40 flex",src:"/favicon.ico"}):c().createElement("p",{className:"font-bold"},"loading...")),c().createElement("div",{className:"flex items-center justify-center flex-col "},c().createElement("div",{className:"container flex items-center"},c().createElement("p",{className:"text-2xl mr-4"},p),y&&null===x?c().createElement("p",{className:"font-bold"},"loading..."):y&&c().createElement("button",{className:"text-xs font-bold text-blue-medium",type:"button",onClick:N,onKeyDown:function(e){"Enter"===e.key&&N()}},x?"Unfollow":"Follow")),c().createElement("div",{className:"container flex mt-4"},i&&m?c().createElement(c().Fragment,null,c().createElement("p",{className:"mr-10"},c().createElement("span",{className:"font-bold"},t)," photos"),c().createElement("p",{className:"mr-10"},c().createElement("span",{className:"font-bold"},n),1===n?"follower":"followers"),c().createElement("p",{className:"mr-10"},c().createElement("span",{className:"font-bold"},null==m?void 0:m.length)," following")):c().createElement("p",{className:"font-bold"},"loading...")),c().createElement("div",{className:"container mt-4"},c().createElement("p",{className:"font-medium"},u||c().createElement("p",{className:"font-bold"},"loading...")))))}function we(e){var t=e.photos;return c().createElement("div",{className:"grid grid-cols-3 gap-8 mt-4"},t?t.length>0?t.map((function(e){return c().createElement("img",{src:e.imageSrc})})):null:new Array(12).fill(0).map((function(e){return c().createElement("p",{className:"font-bold"},"loading...")})))}function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ke(e){var t=e.user,n=(0,o.useReducer)((function(e,t){return Ne(Ne({},e),t)}),{profile:{},photosCollection:null,followerCount:0}),r=h()(n,2),a=r[0],s=a.profile,l=a.photosCollection,u=a.followerCount,i=r[1];return(0,o.useEffect)((function(){function e(){return(e=v()(E().mark((function e(){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(t.userId);case 2:n=e.sent,i({profile:t,photosCollection:n,followerCount:t.followers.length});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t.username]),c().createElement(c().Fragment,null,c().createElement(xe,{photosCount:l?l.length:0,profile:s,followerCount:u,setFollowerCount:i}),c().createElement(we,{photos:l}))}const Ie=[{path:"/",exact:!0,component:function(){return(0,o.useEffect)((function(){document.title="Instagram"}),[]),c().createElement("div",{className:"bg-gray-background"},c().createElement(C,null),c().createElement("div",{className:"grid grid-cols-3 gap-4 justify-between mx-auto max-w-screen-lg"},c().createElement(pe,null),c().createElement(be,null)))}},{path:"/login",exact:!0,component:function(){var e=(0,u.useHistory)(),t=(0,o.useContext)(x),n=(0,o.useState)(""),r=h()(n,2),a=r[0],s=r[1],l=(0,o.useState)(""),i=h()(l,2),m=i[0],p=i[1],f=(0,o.useState)(""),d=h()(f,2),g=d[0],b=d[1],w=""===m||""===a,k=function(){var n=v()(E().mark((function n(r){return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.preventDefault(),n.prev=1,n.next=4,t.firebase.auth().signInWithEmailAndPassword(a,m);case 4:e.push("/"),n.next=12;break;case 7:n.prev=7,n.t0=n.catch(1),s(""),p(""),b(n.t0.message);case 12:case"end":return n.stop()}}),n,null,[[1,7]])})));return function(e){return n.apply(this,arguments)}}();return(0,o.useEffect)((function(){document.title="Login - Instagram"}),[]),c().createElement("div",{className:"container flex mx-auto max-w-screen-md items-center h-screen"},c().createElement("div",{className:"flex flex-col w-2/5 mx-auto"},c().createElement("div",{className:"flex flex-col"},c().createElement("h1",{className:"flex justify-center w-full"},c().createElement("img",{src:N,alt:"Instagram",className:"mt-2 w-6/12 mb-4"})),g&&c().createElement("p",{className:"mb-4 text-xs text-red-primary"},g),c().createElement("form",{onSubmit:k,method:"POST"},c().createElement("input",{"aria-label":"Enter your email address",type:"text",placeholder:"Email address",onChange:function(e){var t=e.target;return s(t.value)},value:a}),c().createElement("input",{"aria-label":"Enter your password",type:"password",placeholder:"Password",onChange:function(e){var t=e.target;return p(t.value)},value:m}),c().createElement("button",{disabled:w,type:"submit",className:"bg-blue-medium"},"Login"))),c().createElement("div",null,c().createElement("p",{className:"text-sm"},"Don't have an account?"," ",c().createElement(u.Link,{to:y,className:"font-bold"},"Sign up")))))}},{path:"/sign-up",exact:!0,component:function(){var e=(0,u.useHistory)(),t=(0,o.useContext)(x),n=(0,o.useState)(""),r=h()(n,2),a=r[0],s=r[1],l=(0,o.useState)(""),i=h()(l,2),m=i[0],p=i[1],f=(0,o.useState)(""),d=h()(f,2),g=d[0],b=d[1],y=(0,o.useState)(""),N=h()(y,2),k=N[0],I=N[1],C=(0,o.useState)(""),j=h()(C,2),O=j[0],S=j[1],P=""===k||""===g,D=function(){var n=v()(E().mark((function n(r){var o;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.preventDefault(),n.next=3,U(a);case 3:if(n.sent){n.next=24;break}return n.prev=5,n.next=8,t.firebase.auth().createUserWithEmailAndPassword(g,k);case 8:return o=n.sent,n.next=11,o.user.updateProfile({displayName:a});case 11:return n.next=13,t.firebase.firestore().collection("users").add({userId:o.user.uid,username:a.toLowerCase(),fullName:m,emailAddress:g.toLowerCase(),following:["2"],followers:[],dateCreated:Date.now()});case 13:e.push("/"),n.next=22;break;case 16:n.prev=16,n.t0=n.catch(5),p(""),b(""),I(""),S(n.t0.message);case 22:n.next=26;break;case 24:s(""),S("That username is already taken, please try another.");case 26:case"end":return n.stop()}}),n,null,[[5,16]])})));return function(e){return n.apply(this,arguments)}}();return(0,o.useEffect)((function(){document.title="Sign Up - Instagram"}),[]),c().createElement("div",{className:"container flex mx-auto max-w-screen-md items-center h-screen"},c().createElement("div",{className:"flex flex-col w-2/5 mx-auto"},c().createElement("div",{className:"flex flex-col"},c().createElement("h1",{className:"flex justify-center w-full"},c().createElement("img",{src:Ee,alt:"Instagram",className:"mt-2 w-6/12 mb-4"})),O&&c().createElement("p",{className:"mb-4 text-xs text-red-primary"},O),c().createElement("form",{onSubmit:D,method:"POST"},c().createElement("input",{"aria-label":"Enter your username",type:"text",placeholder:"Username",onChange:function(e){var t=e.target;return s(t.value)},value:a}),c().createElement("input",{"aria-label":"Enter your full name",type:"text",placeholder:"Full name",onChange:function(e){var t=e.target;return p(t.value)},value:m}),c().createElement("input",{"aria-label":"Enter your email address",type:"text",placeholder:"Email address",onChange:function(e){var t=e.target;return b(t.value)},value:g}),c().createElement("input",{"aria-label":"Enter your password",type:"password",placeholder:"Password",onChange:function(e){var t=e.target;return I(t.value)},value:k}),c().createElement("button",{disabled:P,type:"submit",className:"bg-blue-medium"},"Sign Up"))),c().createElement("div",null,c().createElement("p",{className:"text-sm"},"Have an account?"," ",c().createElement(u.Link,{to:w,className:"font-bold"},"Login")))))}},{path:"/p/raphael",component:function(){var e=(0,u.useParams)(),t=(0,o.useState)(null),n=h()(t,2),r=n[0],a=n[1];return(0,o.useEffect)((function(){function t(){return(t=v()(E().mark((function t(){var n,r,o;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("ASd",e),t.next=3,B(e);case 3:n=t.sent,r=h()(n,1),o=r[0],console.log("345g",o),(null==o?void 0:o.userId)&&a(o);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e]),(null==r?void 0:r.username)?c().createElement("div",{className:"bg-gray-background"},c().createElement(C,null),c().createElement("div",{className:"mx-auto max-w-screen-lg"},c().createElement(ke,{user:r}))):null},exact:!0,fetchInitialData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.split("/").pop()}}],Ce=(0,o.createContext)(null);function je(){var e=function(){var e=(0,o.useContext)(Ce);if(console.log(e),!e)return{};var t=(0,o.useState)(JSON.parse(e.localStorage.getItem("authUser"))),n=h()(t,2),r=n[0],a=n[1],c=(0,o.useContext)(x);return(0,o.useEffect)((function(){var t=c.firebase.auth().onAuthStateChanged((function(t){t?(e.localStorage.setItem("authUser",JSON.stringify(t)),a(t)):(e.localStorage.removeItem("authUser"),a(null))}));return function(){return t()}}),[c]),{user:r}}().user;return o.createElement(k.Provider,{value:{user:e}},o.createElement(u.Switch,null,Ie.map((function(e){var t=e.path,n=e.exact,r=e.fetchInitialData,a=e.component;return o.createElement(u.Route,{key:t,path:t,exact:n,render:function(e){return o.createElement(a,f()({fetchInitialData:r},e))}})}))))}var Oe=t()();Oe.use(a()()),Oe.use(t().static("dist")),Oe.get("*",(function(e,t,n){var r=Ie.find((function(t){return(0,u.matchPath)(e.url,t)}))||{};(r.fetchInitialData?r.fetchInitialData(e.path):Promise.resolve()).then((function(n){var r=l().renderToString(o.createElement(u.StaticRouter,{location:e.url,context:{data:n}},o.createElement(je,null)));t.send('\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <script src="/bundle.js" defer><\/script>\n          <link href="/main.css" rel="stylesheet">\n          <script>window.__INITIAL_DATA__ = '.concat(m()(n),'<\/script>\n        </head>\n\n        <body>\n          <div id="app">').concat(r,"</div>\n        </body>\n      </html>\n    "))})).catch(n)}));var Se=process.env.PORT||3e3;Oe.listen(Se,(function(){console.log("Server is listening on port: ".concat(Se))}))})()})();