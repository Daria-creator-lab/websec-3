{"ast":null,"code":"import { firebase, FieldValue } from '../lib/firebase';\nexport async function doesUsernameExist(username) {\n  const result = await firebase.firestore().collection('users').where('username', '==', username.toLowerCase()).get();\n  return result.docs.length > 0;\n}\nexport async function getUserByUserId(userId) {\n  const result = await firebase.firestore().collection('users').where('userId', '==', userId).get();\n  const user = result.docs.map(item => ({\n    ...item.data(),\n    docId: item.id\n  }));\n  return user;\n}\nexport async function getSuggestedProfiles(userId, following) {\n  const result = await firebase.firestore().collection('users').limit(10).get();\n  return result.docs.map(user => ({\n    ...user.data(),\n    docId: user.id\n  })).filter(profile => profile.userId !== userId && !following.includes(profile.userId));\n}\nexport async function updateLoggedInUserFollowing(loggedInUserDocId, profileId, isFollowingProfile) {\n  return firebase.firestore().collection('users').doc(loggedInUserDocId).update({\n    following: isFollowingProfile ? FieldValue.arrayRemove(profileId) : FieldValue.arrayUnion(profileId)\n  });\n}","map":{"version":3,"names":["firebase","FieldValue","doesUsernameExist","username","result","firestore","collection","where","toLowerCase","get","docs","length","getUserByUserId","userId","user","map","item","data","docId","id","getSuggestedProfiles","following","limit","filter","profile","includes","updateLoggedInUserFollowing","loggedInUserDocId","profileId","isFollowingProfile","doc","update","arrayRemove","arrayUnion"],"sources":["C:/Users/____________________/.vscode/веб 3 лаба Н/websec-3/instagram-clone/src/services/firebase.js"],"sourcesContent":["import { firebase, FieldValue } from '../lib/firebase';\r\n\r\nexport async function doesUsernameExist(username) {\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection('users')\r\n    .where('username', '==', username.toLowerCase())\r\n    .get();\r\n\r\n  return result.docs.length > 0;\r\n}\r\n\r\nexport async function getUserByUserId(userId) {\r\n  const result = await firebase.firestore().collection('users').where('userId', '==', userId).get();\r\n  const user = result.docs.map((item) => ({\r\n    ...item.data(),\r\n    docId: item.id\r\n  }));\r\n\r\n  return user;\r\n}\r\n\r\nexport async function getSuggestedProfiles(userId, following) {\r\n  const result = await firebase.firestore().collection('users').limit(10).get();\r\n\r\n  return result.docs\r\n  .map((user) => ({ ...user.data(), docId: user.id}))\r\n  .filter((profile) => profile.userId !== userId && !following.includes(profile.userId));\r\n}\r\n\r\nexport async function updateLoggedInUserFollowing(\r\n  loggedInUserDocId,\r\n  profileId,\r\n  isFollowingProfile\r\n) {\r\n  return firebase\r\n    .firestore()\r\n    .collection('users')\r\n    .doc(loggedInUserDocId)\r\n    .update({\r\n      following: isFollowingProfile \r\n        ?FieldValue.arrayRemove(profileId) \r\n        :\r\n        FieldValue.arrayUnion(profileId)\r\n    });\r\n}"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,UAAU,QAAQ,iBAAiB;AAEtD,OAAO,eAAeC,iBAAiB,CAACC,QAAQ,EAAE;EAChD,MAAMC,MAAM,GAAG,MAAMJ,QAAQ,CAC1BK,SAAS,EAAE,CACXC,UAAU,CAAC,OAAO,CAAC,CACnBC,KAAK,CAAC,UAAU,EAAE,IAAI,EAAEJ,QAAQ,CAACK,WAAW,EAAE,CAAC,CAC/CC,GAAG,EAAE;EAER,OAAOL,MAAM,CAACM,IAAI,CAACC,MAAM,GAAG,CAAC;AAC/B;AAEA,OAAO,eAAeC,eAAe,CAACC,MAAM,EAAE;EAC5C,MAAMT,MAAM,GAAG,MAAMJ,QAAQ,CAACK,SAAS,EAAE,CAACC,UAAU,CAAC,OAAO,CAAC,CAACC,KAAK,CAAC,QAAQ,EAAE,IAAI,EAAEM,MAAM,CAAC,CAACJ,GAAG,EAAE;EACjG,MAAMK,IAAI,GAAGV,MAAM,CAACM,IAAI,CAACK,GAAG,CAAEC,IAAI,KAAM;IACtC,GAAGA,IAAI,CAACC,IAAI,EAAE;IACdC,KAAK,EAAEF,IAAI,CAACG;EACd,CAAC,CAAC,CAAC;EAEH,OAAOL,IAAI;AACb;AAEA,OAAO,eAAeM,oBAAoB,CAACP,MAAM,EAAEQ,SAAS,EAAE;EAC5D,MAAMjB,MAAM,GAAG,MAAMJ,QAAQ,CAACK,SAAS,EAAE,CAACC,UAAU,CAAC,OAAO,CAAC,CAACgB,KAAK,CAAC,EAAE,CAAC,CAACb,GAAG,EAAE;EAE7E,OAAOL,MAAM,CAACM,IAAI,CACjBK,GAAG,CAAED,IAAI,KAAM;IAAE,GAAGA,IAAI,CAACG,IAAI,EAAE;IAAEC,KAAK,EAAEJ,IAAI,CAACK;EAAE,CAAC,CAAC,CAAC,CAClDI,MAAM,CAAEC,OAAO,IAAKA,OAAO,CAACX,MAAM,KAAKA,MAAM,IAAI,CAACQ,SAAS,CAACI,QAAQ,CAACD,OAAO,CAACX,MAAM,CAAC,CAAC;AACxF;AAEA,OAAO,eAAea,2BAA2B,CAC/CC,iBAAiB,EACjBC,SAAS,EACTC,kBAAkB,EAClB;EACA,OAAO7B,QAAQ,CACZK,SAAS,EAAE,CACXC,UAAU,CAAC,OAAO,CAAC,CACnBwB,GAAG,CAACH,iBAAiB,CAAC,CACtBI,MAAM,CAAC;IACNV,SAAS,EAAEQ,kBAAkB,GAC1B5B,UAAU,CAAC+B,WAAW,CAACJ,SAAS,CAAC,GAElC3B,UAAU,CAACgC,UAAU,CAACL,SAAS;EACnC,CAAC,CAAC;AACN"},"metadata":{},"sourceType":"module"}